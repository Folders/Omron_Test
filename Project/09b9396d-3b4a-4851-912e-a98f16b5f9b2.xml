<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class FileManagement&#xD;
</HiddenHeader><SerialData i:nil="true"/><SerialDeviceHmiId i:nil="true"/><SerialScaleData i:nil="true"/><Text>'Code behind Page - Add local subroutines for the page.&#xD;
&#xD;
Public Const PATH = "C:\Test\Inverter\"	'	"\SDCard\Inverter\"&#xD;
&#xD;
&#xD;
Sub File_Create&#xD;
	&#xD;
	Dim Source As String&#xD;
	&#xD;
	' Create path if dosen't existe &#xD;
	If (Not System.IO.Directory.Exists(PATH)) Then&#xD;
    	System.IO.Directory.CreateDirectory(PATH)&#xD;
	End If	&#xD;
		&#xD;
&#xD;
	' Import recipe file for master recipe&#xD;
	Dim _name As String = FileName&#xD;
	&#xD;
	' Import recipe file for master recipe&#xD;
	_name.Replace(":"c, "-"c)				' Replace :&#xD;
	_name.Replace( Microsoft.VisualBasic.Chr(34), "'"c)		' Replace "	&#xD;
	Source = Path + _name +".the"&#xD;
	&#xD;
		&#xD;
		' Load recipe if file existe&#xD;
		If Not System.IO.File.Exists(Source) Then&#xD;
			&#xD;
			' Create or overwrite the file.&#xD;
        	Dim fs As System.IO.FileStream = System.IO.File.Create(Source)&#xD;
			&#xD;
		End If	&#xD;
&#xD;
		&#xD;
End Sub&#xD;
&#xD;
Sub File_Read&#xD;
	&#xD;
	Dim fileReader As String&#xD;
	Dim Source As String&#xD;
	&#xD;
	' Import recipe file for master recipe&#xD;
	Dim _name As String = FileName&#xD;
	&#xD;
	' Import recipe file for master recipe&#xD;
	_name = _name.Replace(":"c, "-"c)				' Replace :&#xD;
	_name = _name.Replace( Microsoft.VisualBasic.Chr(34), "'"c)		' Replace "	&#xD;
	Source = Path + _name +".the"&#xD;
	&#xD;
	' If file existe&#xD;
	If System.IO.File.Exists(Source) Then&#xD;
				&#xD;
		' Open the file to read from.&#xD;
		Using sr As System.IO.StreamReader = System.IO.File.OpenText(Source)&#xD;
			a_SP = sr.ReadLine()&#xD;
			b_SP = sr.ReadLine()&#xD;
			a_FB = sr.ReadLine()&#xD;
			b_FB = sr.ReadLine()&#xD;
		End Using&#xD;
	Else&#xD;
		System.Windows.Forms.MessageBox.Show("No value backups found")&#xD;
	End If &#xD;
	&#xD;
End Sub&#xD;
&#xD;
Sub File_Save&#xD;
	&#xD;
	' Create path if dosen't existe &#xD;
	If (Not System.IO.Directory.Exists(PATH)) Then&#xD;
    	System.IO.Directory.CreateDirectory(PATH)&#xD;
	End If	&#xD;
	&#xD;
	' Import recipe file for master recipe&#xD;
	Dim Source As String&#xD;
&#xD;
		' Import recipe file for master recipe&#xD;
	Dim _name As String = FileName&#xD;
	&#xD;
	' Import recipe file for master recipe&#xD;
	_name = _name.Replace(":"c, "-"c)				' Replace :&#xD;
	_name = _name.Replace( Microsoft.VisualBasic.Chr(34), "'"c)		' Replace "	&#xD;
	Source = Path + _name +".the"&#xD;
	&#xD;
	Me.L_Dir.Text = Source&#xD;
	&#xD;
	' Open the file to read from.&#xD;
	Using sw As System.IO.StreamWriter  = System.IO.File.CreateText(Source)&#xD;
		sw.WriteLine(a_SP)&#xD;
		sw.WriteLine(b_SP)&#xD;
		sw.WriteLine(a_FB)&#xD;
		sw.WriteLine(b_FB)&#xD;
	End Using&#xD;
	&#xD;
	&#xD;
		System.Windows.Forms.MessageBox.Show("Datas saved")&#xD;
		&#xD;
End Sub&#xD;
</Text></CodeEditorModel>