<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class PU_Date&#xD;
</HiddenHeader><SerialData i:type="a:string" xmlns:a="http://www.w3.org/2001/XMLSchema">[{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"Array which contains the Numbers of the calendar pop-up","RawComment":null,"DataTypeName":"Short(42)","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"e46d9c36-1c37-48f8-910c-63d5c684c0b6","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Calendar","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"Array of bits that disables the day cells of the previous/next month in the calendar pop-up","RawComment":null,"DataTypeName":"Boolean(42)","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"1281bf0b-541c-4b9f-84b9-be6550e0f4ea","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Calendar_Disabled","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"Sepcipies which day cell is selected in the calendar pop-up","RawComment":null,"DataTypeName":"Short","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"f6d00a79-c0df-4c5a-ba6e-ae6bac2dda5a","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Calendar_Selection","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"String that displays the month corresponding to the day cells in the calendar pop-up","RawComment":null,"DataTypeName":"String","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"787d712d-d563-4205-9023-aca2e09aa5fb","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"DisplayedMonth","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"Year corresponding to the day cells and month in the calendar pop-up","RawComment":null,"DataTypeName":"String","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"afb7bda7-d0d1-40dc-b226-7ac49aad3dba","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"DisplayedYear","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"Bit that specifies whether the first or the second date is selected in the calendar pop-up","RawComment":null,"DataTypeName":"Boolean","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"5016e817-2b8e-4811-8577-2cf6525160de","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"From_To_DateSelected","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"second Variable Used for the time filter","RawComment":null,"DataTypeName":"Date","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"61a09037-c279-496b-9347-2f8401a199ee","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"FromDate","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"first Variable Used for the time filter","RawComment":null,"DataTypeName":"Date","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"7a490ea0-fbcd-408b-bdd4-429d23e01814","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"ToDate","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}}]</SerialData><SerialDeviceHmiId i:type="a:string" xmlns:a="http://www.w3.org/2001/XMLSchema">[{"t":"System.String","a":"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089","o":"976826c8-9cad-498a-8083-a459c27d353b"},{"t":"System.String","a":"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089","o":"df045bad-ce4f-4077-a979-911df18b34b9"}]</SerialDeviceHmiId><SerialScaleData i:type="a:string" xmlns:a="http://www.w3.org/2001/XMLSchema">[]</SerialScaleData><Text>&#xD;
Private Dim day As Short					'day used to form the Reference virtual date&#xD;
Private Dim month As Short			'month used to form the Reference virtual date&#xD;
Private Dim year As Short				'year used to form the Reference virtual date&#xD;
Private Dim DateNav As Date			'Reference virtual date&#xD;
Private Dim FirstDate As Date			'Output if the user select the first date&#xD;
Private Dim LastDate As Date			'Output if the user select the last date&#xD;
Private Dim DayBefore As Date		'Used to display grey cells to days before the displed month&#xD;
Private Dim DayWeek As Short		'Current day of the week (0=sunday, 1=monday, 2=tuesday etc...)&#xD;
Private Dim DaysMonth As Short	'number of days in the current month&#xD;
Private Dim i As Short						'Index used in the For loops&#xD;
Private Dim iday As Short				'Other index used in For Loops&#xD;
&#xD;
Sub OnOpen&#xD;
	day = 1										'Defines the first day of the current month in the current year&#xD;
	month = Date.Now.Month			'Defines the current month&#xD;
	year = Date.Now.Year					'Defines the current year&#xD;
 	Call Fill&#xD;
	&#xD;
End Sub&#xD;
&#xD;
Sub MonthPrev&#xD;
	If month &gt;1 Then		'Substract a month to the current date&#xD;
		month -= 1&#xD;
	Else								'If the month is January, we have to substract a year and define the current month as December&#xD;
		year-=1&#xD;
		month=12&#xD;
	End If&#xD;
	Call Fill&#xD;
End Sub&#xD;
&#xD;
Sub MonthNext			'Routine called when the user press the "Next" button&#xD;
	&#xD;
	'If the current month is not december, increment a month&#xD;
	If month&lt;12 Then&#xD;
		month += 1&#xD;
	'Else the current month becomes january and a year is incremented&#xD;
	Else&#xD;
		year+=1&#xD;
		month=1&#xD;
	End If&#xD;
	'Call the fill routine&#xD;
	Call Fill&#xD;
End Sub&#xD;
&#xD;
Sub Fill						' Subroutine which fills the dates of the calendar&#xD;
	iday=1&#xD;
	'Create a virtual Date correponding to the fist day of the current month and year&#xD;
	DateNav = Convert.ToDateTime(CStr(day) + "/" + CStr(month) + "/" + CStr(year) )   &#xD;
	'Gets the number of days in the current month&#xD;
	DaysMonth=DateNav.DaysInMonth(DateNav.Year,DateNav.Month)			&#xD;
	' Offset to put the Monday in the first column&#xD;
	DayBefore=DateNav.AddDays(-1)&#xD;
	DayWeek=DateNav.DayOfWeek - 2																				&#xD;
	If DayWeek=-2 Then																							&#xD;
		DayWeek=5&#xD;
	End If	&#xD;
	&#xD;
	'Loop that fills the array in the correct order&#xD;
	For i= 0 To 41																									&#xD;
		'Check if the fist cell is not a monday&#xD;
		If i&lt;=DayWeek Then&#xD;
			'If it'a an other day substract its value at the first of the month to get the correct number to begin with&#xD;
			Calendar(i)=DayBefore.Day-(DayWeek-i)&#xD;
			'Activation of the gray cells for the days before the current month&#xD;
			Calendar_Disabled(i)=True&#xD;
		' If it's a monday begin by 1&#xD;
		Else&#xD;
			Calendar(i)= iday&#xD;
			Calendar_Disabled(i)=False&#xD;
			If iday&gt;DaysMonth Then&#xD;
				Calendar(i)=iday-DaysMonth&#xD;
				Calendar_Disabled(i)=True&#xD;
			End If&#xD;
			iday += 1&#xD;
		End If&#xD;
	Next&#xD;
	&#xD;
	'If the displayed month is the actual one, show the blue cell at the actual date&#xD;
	If month = Date.Now.Month And year = Date.Now.Year Then&#xD;
		Calendar_Selection= Date.Now.Day+DayWeek&#xD;
		'Disable the button next (used for the alarm filter)&#xD;
		B_Next.IsEnabled=False&#xD;
			&#xD;
		'Disable all cells after the current date (used for the alarm filter)&#xD;
		For i=Date.Now.Day+DayWeek+1 To 41&#xD;
			Calendar_Disabled(i)=True&#xD;
		Next&#xD;
	Else&#xD;
		Calendar_Selection= -1&#xD;
		B_Next.IsEnabled=True&#xD;
	End If&#xD;
	&#xD;
&#xD;
	'Manage the displayed month of the pop-up&#xD;
	DisplayedMonth=GetResourceString("THE_Month_" + month.ToString("00") ) &#xD;
	DisplayedYear=year	&#xD;
End Sub&#xD;
&#xD;
Sub OnSelect 'Routine exectued when the user selects a cell in the calendar&#xD;
&#xD;
	If From_To_DateSelected Then&#xD;
		'If the user clicks on the first Date&#xD;
		FirstDate=Convert.ToDateTime(CStr(DateNav.Year)+"/"+CStr(DateNav.Month)+"/"+CStr(Calendar(Calendar_Selection)))&#xD;
	Else												&#xD;
		'If the user clicks on the second Date&#xD;
		LastDate=Convert.ToDateTime(CStr(DateNav.Year)+"/"+CStr(DateNav.Month)+"/"+CStr(Calendar(Calendar_Selection)))&#xD;
	End If&#xD;
	&#xD;
End Sub&#xD;
&#xD;
Sub OnValidate		'When the user clicks on the "Validate" button, the variables are set&#xD;
	If From_To_DateSelected Then&#xD;
		FromDate=FirstDate&#xD;
	Else&#xD;
		ToDate=LastDate&#xD;
	End If&#xD;
	&#xD;
	ShowPage("Alarms_PU_TimeFilter")&#xD;
	End Sub&#xD;
	</Text></CodeEditorModel>