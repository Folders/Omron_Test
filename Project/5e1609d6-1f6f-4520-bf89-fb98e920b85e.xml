<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class List_IAG&#xD;
</HiddenHeader><SerialData i:type="a:string" xmlns:a="http://www.w3.org/2001/XMLSchema">[{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"","RawComment":null,"DataTypeName":"Short","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"62598d44-26e3-4c98-a959-981f17de461a","InitialValue":"-1","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Pos","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"List of items from select pop-up","RawComment":null,"DataTypeName":"String(10)","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"b2625111-b7d4-4209-9f31-222d6d5153f4","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Viewer","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"","RawComment":null,"DataTypeName":"String","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"c2219c55-2384-4f04-bc08-844f59f44dfe","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Item_Select","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"","RawComment":null,"DataTypeName":"String","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"ec3bd361-f796-4bd5-8ea1-e4e6f73b1688","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Item_Value","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"","RawComment":null,"DataTypeName":"Boolean","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"21bf5972-d68f-4161-8dbe-939a32a6fb81","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Nav_Left","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}},{"t":"Omron.Cxap.Modules.DeviceHmi.Variables.Core.Variable","a":"Omron.Cxap.Modules.DeviceHmi.Module, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f8cd6ce856ce25c","o":{"Address":"","Comment":"","RawComment":null,"DataTypeName":"Boolean","Edge":{"v":"NoEdge"},"ElementComments":null,"Group":{"v":"VAR_GLOBAL"},"IsAddedInOnlineEdit":false,"IsModifiedInitialValueInOnlineEdit":false,"Id":"b4dd82f2-5c83-42f5-922f-536b8d049946","InitialValue":"","IsConstant":false,"IsControllerVariable":false,"IsReadOnly":false,"IsReadOnlyNetwork":false,"Length":"","Name":"Nav_Icon","NamespaceId":"00000000-0000-0000-0000-000000000000","NetworkPublication":{"v":"NoPublication"},"Order":"","Retained":false,"UpdateRate":0,"MappedDeviceName":"","InitialValueArrayLength":"","ScalingConfigurationId":null,"Scaling":"None"}}]</SerialData><SerialDeviceHmiId i:type="a:string" xmlns:a="http://www.w3.org/2001/XMLSchema">[{"t":"System.String","a":"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089","o":"8b864637-73ac-4429-8a1b-055ed8d4ef63"},{"t":"System.String","a":"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089","o":"55aa2ac1-2239-47fe-b692-02dad282421d"}]</SerialDeviceHmiId><SerialScaleData i:type="a:string" xmlns:a="http://www.w3.org/2001/XMLSchema">[]</SerialScaleData><Text>' NORMALY IN EVENT OF IAG&#xD;
Public Event OnChange()&#xD;
&#xD;
&#xD;
'IAG Code behind - Add local subroutines for the IAG.&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Event when list is updated with the values&#xD;
''' &lt;/summary&gt;&#xD;
Public Event OnChangeDatas(ByVal View As String, ByVal Value As String)&#xD;
	&#xD;
Private Dim _AryView As String()		' Value to show for the list&#xD;
Private Dim _AryValue As String()	' Value to give from the list&#xD;
Private Dim _max As Integer		' Number of items&#xD;
Private Dim	_page As Integer		' Indice of current page&#xD;
Private Dim i As Integer&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' The list box as only some viewed data, or value behind the viewed data (Value)&#xD;
''' &lt;/summary&gt;&#xD;
Public Dim AsValue As Boolean	&#xD;
&#xD;
&#xD;
#Region "Filling list"&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Set a list for the list viewer, but return the value from the other table&#xD;
''' &lt;/summary&gt;&#xD;
''' &lt;param name="view"&gt;Array of datas to put on the list&lt;/param&gt;&#xD;
''' &lt;param name="value"&gt;Optional value of the datas&lt;/param&gt;&#xD;
Public Sub SetList( view As String(), Optional value As String() = Nothing)&#xD;
	&#xD;
    ' Exit if view is empty&#xD;
    If view Is Nothing Then Exit Sub&#xD;
&#xD;
    ' Copy view  to _AryView and set _max&#xD;
    _AryView = CType(view.Clone(), String())&#xD;
    _max = _AryView.Length&#xD;
&#xD;
    ' Check if we have value for the view&#xD;
    If value IsNot Nothing Then&#xD;
        ' Copy value array to _AryValue&#xD;
        _AryValue = CType(value.Clone(), String())&#xD;
        AsValue = True&#xD;
    Else&#xD;
        AsValue = False&#xD;
    End If&#xD;
&#xD;
    ' Unselect&#xD;
    _page = 0&#xD;
    _ResetPos()&#xD;
End Sub&#xD;
&#xD;
#End Region&#xD;
&#xD;
#Region "Navigation"&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Clic on up button&#xD;
''' &lt;/summary&gt;&#xD;
Private Sub ClickUp&#xD;
	_page -=10&#xD;
	_ResetPos()&#xD;
End Sub&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Clic on down button&#xD;
''' &lt;/summary&gt;&#xD;
Private Sub ClickDown&#xD;
	_page+=10&#xD;
	_ResetPos()&#xD;
End Sub&#xD;
&#xD;
Private Sub _ResetPos&#xD;
	Pos = -1&#xD;
	Selected = ""&#xD;
	Call Fill&#xD;
End Sub&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Update page list after a page change&#xD;
''' &lt;/summary&gt;&#xD;
Private Sub Fill&#xD;
	&#xD;
	'Loop that fills the selection list&#xD;
	For i=0 To 9 &#xD;
		If i + _page &lt;=_max -1 And _max &gt; 0 Then&#xD;
			Viewer(i) =_AryView(_page+i)&#xD;
		Else&#xD;
			Viewer(i) = ""&#xD;
		End If&#xD;
	Next i&#xD;
	&#xD;
	' Control of up buton&#xD;
	B_Up.IsEnabled = (_page &lt;&gt; 0)&#xD;
&#xD;
	' Enable down buton if needed&#xD;
	B_Down.IsEnabled = (_max &gt; 10 + _page)&#xD;
&#xD;
End Sub&#xD;
&#xD;
#End Region&#xD;
&#xD;
&#xD;
&#xD;
#Region "Selection"&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Call when user select a line&#xD;
''' &lt;/summary&gt;&#xD;
Private Sub OnSelect&#xD;
	&#xD;
	'If the selected cell is not empty load its value in a variable&#xD;
	If Pos &gt; -1 Then&#xD;
		If Viewer(Pos) &lt;&gt; "" Then&#xD;
			' Set value to output&#xD;
			Selected = _AryView(Pos+_page)&#xD;
		End If&#xD;
	End If&#xD;
	&#xD;
End Sub&#xD;
&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Text of selected item. Empty if any item is selected.&#xD;
''' &lt;/summary&gt;&#xD;
Public Property Selected As String&#xD;
	&#xD;
    Get&#xD;
		Return _Selected&#xD;
    End Get&#xD;
	&#xD;
    Private Set(ByVal val As String)&#xD;
		' Check if the state change&#xD;
		If _Selected &lt;&gt; val Then&#xD;
			&#xD;
			' Update value&#xD;
        	_Selected = val&#xD;
			&#xD;
			' Update value if needed&#xD;
			If AsValue And Pos &gt;= 0 Then&#xD;
				' Set value to output&#xD;
				Value = _AryValue(Pos+_page)&#xD;
			Else&#xD;
				Value = _Selected&#xD;
			End If&#xD;
			&#xD;
			' Set output value&#xD;
			Item_Select = _Selected&#xD;
			&#xD;
			RaiseEvent OnChange&#xD;
			RaiseEvent OnChangeDatas(_Selected, _Value)&#xD;
			&#xD;
		End If&#xD;
    End Set&#xD;
	&#xD;
End Property&#xD;
Private _Selected As String = ""&#xD;
&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Value of selected item. If value are not used, it will return the selected value&#xD;
''' &lt;/summary&gt;&#xD;
Public Property Value As String&#xD;
	&#xD;
    Get&#xD;
		Return _Value&#xD;
    End Get&#xD;
	&#xD;
    Private Set(ByVal val As String)&#xD;
		' Check if the state change&#xD;
		If _Value &lt;&gt; val Then&#xD;
			&#xD;
			' Update value&#xD;
        	_Value = val&#xD;
			&#xD;
			' Set output value&#xD;
			Item_Value = _Value&#xD;
			&#xD;
		End If&#xD;
    End Set&#xD;
	&#xD;
End Property&#xD;
Private _Value As String = ""&#xD;
&#xD;
#End Region&#xD;
&#xD;
&#xD;
''' &lt;summary&gt;&#xD;
''' Update drawing &#xD;
''' &lt;/summary&gt;&#xD;
Private Sub UI_Draw&#xD;
&#xD;
	Dim Left As Double = Me.R_Background.Left&#xD;
	&#xD;
	' When value is 0, the variable is NaN ???&#xD;
	If  System.Double.IsNaN(Left) Then&#xD;
		Left = 0	&#xD;
	End If&#xD;
	&#xD;
	' Move menu&#xD;
	If Nav_Left Then&#xD;
		G_Button.Left = Left&#xD;
		G_List.Left = Left + Me.R_Button.Width&#xD;
	Else&#xD;
		G_List.Left = Left&#xD;
		G_Button.Left = Left + Me.R_Nav.Width&#xD;
	End If&#xD;
&#xD;
	' If no icon&#xD;
	If Nav_Icon = False Then&#xD;
		' Hide icon and move caption&#xD;
		Me.I_Icone.IsVisible = False&#xD;
		&#xD;
		' Update size of button&#xD;
		Me.B_Up.Height = Me.R_Button.Height / 2&#xD;
		Me.B_Down.Height = Me.R_Button.Height / 2&#xD;
		Me.B_Down.Top = Me.R_Button.Height / 2&#xD;
	Else&#xD;
		' Show icon and move caption&#xD;
		Me.I_Icone.IsVisible = True&#xD;
		&#xD;
		' Update size of button&#xD;
		Me.B_Up.Height = Me.R_Button.Height / 2 - 40&#xD;
		Me.B_Down.Height = Me.R_Button.Height / 2 - 40&#xD;
		Me.B_Down.Top = Me.R_Button.Height / 2 + 40&#xD;
	End If&#xD;
	&#xD;
End Sub&#xD;
</Text></CodeEditorModel>