<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class WakeUp&#xD;
</HiddenHeader><SerialData i:nil="true"/><SerialDeviceHmiId i:nil="true"/><SerialScaleData i:nil="true"/><Text>'Code behind Page - Add local subroutines for the page.&#xD;
&#xD;
Sub NextAlarms&#xD;
	&#xD;
		 Dim dt, nextDate As DateTime&#xD;
		 Dim dayIndex As Integer&#xD;
		 &#xD;
		 ' Get the current date&#xD;
		 dt = DateTime.Now&#xD;
		 &#xD;
		 ' And create the wake up time&#xD;
		 nextDate = New DateTime(dt.Year, dt.Month, dt.Day, HMI.WakeUp.Time_Hour, HMI.WakeUp.Time_Min, 0)&#xD;
		 dayIndex = dt.DayOfWeek&#xD;
		 &#xD;
		Me.L_Out.Text = "0: " + nextDate.ToString("yyyy-MM-dd HH:mm")&#xD;
		 &#xD;
		Dim i As Integer = 0&#xD;
		' Check if day is valide&#xD;
		Do While i &lt;= 7&#xD;
			&#xD;
			If nextDate &gt; dt And  HMi.WakeUp.Days( (dayIndex+i) Mod 7) Then&#xD;
				Exit Do&#xD;
			End If &#xD;
			&#xD;
			' If not valide, add one day and check the next day&#xD;
			nextDate = nextDate.AddDays(1)&#xD;
		    i += 1&#xD;
			&#xD;
			Me.L_Out.Text =  Me.L_Out.Text  + Environment.NewLine + i.ToString +  ":  " +nextDate.ToString("yyyy-MM-dd HH:mm")&#xD;
		Loop&#xD;
		 &#xD;
		 If nextDate &gt; dt And i &lt; 8 Then&#xD;
		 	Me.L_Out.Text = Me.L_Out.Text + Environment.NewLine + " FINAL:" +nextDate.ToString("yyyy-MM-dd HH:mm")&#xD;
		Else&#xD;
			Me.L_Out.Text =  Me.L_Out.Text  + Environment.NewLine+  "Nop"&#xD;
		End If&#xD;
		&#xD;
End Sub&#xD;
</Text></CodeEditorModel>